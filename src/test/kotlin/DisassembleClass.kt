import codes.som.anthony.aksara.disassembler.disassembleClassNode
import codes.som.anthony.aksara.disassembler.writeAST
import codes.som.anthony.aksara.output.BasicOutput
import org.objectweb.asm.ClassReader
import org.objectweb.asm.tree.ClassNode
import java.util.*

fun main() {
    val buffer = Base64.getDecoder().decode("""yv66vgAAADEASgEAB05hTlRlc3QHAAEBABBqYXZhL2xhbmcvT2JqZWN0BwADAQABYQEABChEKUoB
ABBqYXZhL2xhbmcvRG91YmxlBwAHAQATZG91YmxlVG9SYXdMb25nQml0cwwACQAGCgAIAAoFAAD/
//////8BAAFiAQAEKEopQwUAAAAAAAD//wMAAAAAAQABYwUAAAAA//8AAAMAAAAQAQABZAUAAP//
AAAAAAMAAAAgAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYGf/AAYwBiAGEMAAUABgoA
AgAfDAAOAA8KAAIAIQwAEwAPCgACACMMABcADwoAAgAlBn/wAGYAZQBkBn/wAGkAaABnBn/wAGwA
awBqBn/wAG8AbgBtBn/wAHIAcQBwBn/wAHUAdABzBn/wAHgAdwB2Bn/wACEAegB5AQAQamF2YS9s
YW5nL1N5c3RlbQcANwEAA291dAEAFUxqYXZhL2lvL1ByaW50U3RyZWFtOwwAOQA6CQA4ADsBABBq
YXZhL2xhbmcvU3RyaW5nBwA9AQAGPGluaXQ+AQAFKFtDKVYMAD8AQAoAPgBBAQATamF2YS9pby9Q
cmludFN0cmVhbQcAQwEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYMAEUARgoARABH
AQAEQ29kZQABAAIABAAAAAAABQAKAAUABgABAEkAAAAVAAQAAgAAAAkmuAALFAAMf60AAAAAAAoA
DgAPAAEASQAAABYABAACAAAACh4UABB/EhJ7iKwAAAAAAAoAEwAPAAEASQAAABYABAACAAAACh4U
ABR/EhZ7iKwAAAAAAAoAFwAPAAEASQAAABYABAACAAAACh4UABh/Ehp7iKwAAAAAAAkAGwAcAAEA
SQAAAZUABAACAAABiREBALwFTCsDFAAduAAguAAiklUrBBQAHbgAILgAJJJVKwUUAB24ACC4ACaS
VSsGFAAnuAAguAAiklUrBxQAJ7gAILgAJJJVKwgUACe4ACC4ACaSVSsQBhQAKbgAILgAIpJVKxAH
FAApuAAguAAkklUrEAgUACm4ACC4ACaSVSsQCRQAK7gAILgAIpJVKxAKFAAruAAguAAkklUrEAsU
ACu4ACC4ACaSVSsQDBQALbgAILgAIpJVKxANFAAtuAAguAAkklUrEA4UAC24ACC4ACaSVSsQDxQA
L7gAILgAIpJVKxAQFAAvuAAguAAkklUrEBEUAC+4ACC4ACaSVSsQEhQAMbgAILgAIpJVKxATFAAx
uAAguAAkklUrEBQUADG4ACC4ACaSVSsQFRQAM7gAILgAIpJVKxAWFAAzuAAguAAkklUrEBcUADO4
ACC4ACaSVSsQGBQANbgAILgAIpJVKxAZFAA1uAAguAAkklUrEBoUADW4ACC4ACaSVbIAPLsAPlkr
twBCtgBIsQAAAAAAAA==""".replace("\n", ""))

    val node = ClassNode()
    ClassReader(buffer).accept(node, 0)

    val prog = disassembleClassNode(node)
    println(BasicOutput().apply { writeAST(prog, this) }.contents)
}
